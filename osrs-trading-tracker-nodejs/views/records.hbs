<div class="container mt-4">
    <h1 class="page-title">
        <i class="fas fa-scroll treasure-icon me-3"></i>
        Trading Archives
        <i class="fas fa-book treasure-icon ms-3"></i>
    </h1>

    <!-- Filter Buttons -->
    <div class="filter-buttons">
        <h5 style="color: var(--osrs-gold); font-family: 'MedievalSharp', cursive; margin-bottom: 20px;">
            🏰 Trading Records 🏰
        </h5>
        <div class="btn-group" role="group">
            <a href="/records" class="btn btn-outline-primary active">
                <i class="fas fa-list me-2"></i>📜 All Records
            </a>
        </div>
    </div>

    <div class="rune-divider">
        <i class="fas fa-dice-d20"></i> ⚔️ <i class="fas fa-coins"></i> ⚔️ <i class="fas fa-gem"></i> ⚔️ <i class="fas fa-dice-d20"></i>
    </div>

    <!-- Records Table -->
    <div class="table-container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 style="color: var(--osrs-brown); font-family: 'MedievalSharp', cursive;">
                <i class="fas fa-treasure-chest me-2 treasure-icon"></i>
                📊 Trading Ledger
                {{#if status}}
                    <span class="badge ms-2 {{#eq status 'finished'}}status-badge-finished{{else}}status-badge-selling{{/eq}}">
                        {{#eq status 'finished'}}✅ Completed{{else}}🔄 Active{{/eq}}
                    </span>
                {{/if}}
            </h4>
            <div>
                <small style="color: var(--osrs-brown); font-weight: bold;">
                    <i class="fas fa-scroll me-1"></i>
                    Total Entries: {{records.length}}
                </small>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                <tr>
                    <th><i class="fas fa-gem me-1"></i>⚔️ Item</th>
                    <th><i class="fas fa-user me-1"></i>🧙 Account</th>
                    <th><i class="fas fa-shopping-cart me-1"></i>📦 Bought</th>
                    <th><i class="fas fa-hand-holding-usd me-1"></i>💰 Sold</th>
                    <th><i class="fas fa-coins me-1"></i>💵 Buy Price</th>
                    <th><i class="fas fa-money-bill-wave me-1"></i>💸 Sell Price</th>
                    <th><i class="fas fa-receipt me-1"></i>🧾 Tax</th>
                    <th><i class="fas fa-chart-line me-1"></i>📈 Profit</th>
                    <th><i class="fas fa-divide me-1"></i>⚖️ Per Unit</th>
                    <th><i class="fas fa-clock me-1"></i>🕐 First Buy</th>
                    <th><i class="fas fa-clock me-1"></i>🕕 Last Sell</th>
                </tr>
                </thead>
                <tbody>
                {{#each records}}
                    <tr>
                        <td><strong style="color: var(--osrs-brown);">🗡️ {{item}}</strong></td>
                        <td><span style="color: var(--osrs-blue); font-weight: bold;">{{account}}</span></td>
                        <td><strong>{{formatNumber bought}}</strong></td>
                        <td><strong>{{formatNumber sold}}</strong></td>
                        <td><span style="color: var(--osrs-brown);">{{formatNumber avg_buy_price}} GP</span></td>
                        <td><span style="color: var(--osrs-brown);">{{formatNumber avg_sell_price}} GP</span></td>
                        <td><span style="color: var(--osrs-red);">{{formatNumber tax}} GP</span></td>
                        <td>
                            <strong class="{{#gt profit 0}}profit-positive{{else}}profit-negative{{/gt}}">
                                {{formatNumber profit}} GP
                            </strong>
                        </td>
                        <td>
                        <span class="{{#gt profit_ea 0}}profit-positive{{else}}profit-negative{{/gt}}">
                            {{formatNumber profit_ea}} GP
                        </span>
                        </td>
                        <td><small style="color: var(--osrs-blue);">{{formatDateTime first_buy_time}}</small></td>
                        <td><small style="color: var(--osrs-blue);">{{formatDateTime last_sell_time}}</small></td>
                    </tr>
                {{else}}
                    <tr>
                        <td colspan="12" class="text-center py-5">
                            <div style="color: var(--osrs-brown);">
                                <i class="fas fa-search fa-3x mb-3 loading-spinner"></i>
                                <h4>No Trading Records Found</h4>
                                <p>🏰 Your trading adventure awaits! Import some data to begin your quest.</p>
                                {{#if ../isAdmin}}
                                    <a href="/upload" class="btn btn-primary mt-3">
                                        <i class="fas fa-upload me-2"></i>📤 Import Trading Data
                                    </a>
                                {{/if}}
                            </div>
                        </td>
                    </tr>
                {{/each}}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Footer -->
    <div class="text-center mt-5 mb-4">
        <p style="color: var(--osrs-gold); font-family: 'MedievalSharp', cursive; font-size: 1.2rem;">
            📜 Every great fortune starts with a single trade! 📜
        </p>
    </div>
</div>

<style>
    body {
        background:
            radial-gradient(circle at 15% 30%, rgba(255,215,0,0.12) 0%, transparent 55%),
            radial-gradient(circle at 85% 80%, rgba(139,69,19,0.1) 0%, transparent 50%),
            radial-gradient(circle at 50% 10%, rgba(255,215,0,0.06) 0%, transparent 45%),
            linear-gradient(145deg, #2c1810 0%, #1a1a2e 25%, #0f172a 50%, #1e293b 75%, #334155 100%),
            repeating-radial-gradient(circle at 50% 50%, transparent 0px, transparent 8px, rgba(255,215,0,0.02) 8px, rgba(255,215,0,0.02) 16px);
        background-size: 380px 380px, 420px 420px, 280px 280px, 100% 100%, 40px 40px;
        background-attachment: fixed;
        min-height: 100vh;
        animation: scrollShimmer 22s ease-in-out infinite;
    }

    @keyframes scrollShimmer {
        0%, 100% { filter: brightness(1) contrast(1); }
        50% { filter: brightness(1.05) contrast(1.1); }
    }

    .table-container {
        background: linear-gradient(145deg, var(--parchment), #E6D7C3);
        border: 8px solid var(--osrs-brown);
        border-radius: 25px;
        padding: 30px;
        margin: 25px 0;
        box-shadow:
            0 15px 35px rgba(0,0,0,0.3),
            inset 0 2px 15px rgba(255,215,0,0.1);
        position: relative;
        overflow: hidden;
    }

    .table-container::before {
        content: "";
        position: absolute;
        top: -4px;
        left: -4px;
        right: -4px;
        bottom: -4px;
        background: linear-gradient(45deg, var(--osrs-gold), var(--osrs-brown), var(--osrs-gold));
        z-index: -1;
        border-radius: 29px;
    }

    .profit-positive {
        color: var(--osrs-green);
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    .profit-negative {
        color: var(--osrs-red);
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    .page-title {
        font-family: 'MedievalSharp', cursive;
        color: var(--osrs-gold);
        text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
        font-size: 3rem;
        text-align: center;
        margin-bottom: 40px;
    }

    .filter-buttons {
        background: linear-gradient(145deg, var(--osrs-brown), var(--osrs-dark-brown));
        border: 4px solid var(--osrs-gold);
        border-radius: 20px;
        padding: 20px;
        margin-bottom: 25px;
        text-align: center;
        box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    .btn {
        border-radius: 15px;
        font-weight: 600;
        transition: all 0.3s ease;
        border: 3px solid transparent;
        font-family: 'Cinzel', serif;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin: 5px;
    }

    .btn-outline-primary {
        border-color: var(--osrs-blue);
        color: var(--osrs-blue);
        background: rgba(255,255,255,0.9);
    }

    .btn-outline-primary:hover, .btn-outline-primary.active {
        background: var(--osrs-blue);
        border-color: var(--osrs-gold);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    .btn-outline-success {
        border-color: var(--osrs-green);
        color: var(--osrs-green);
        background: rgba(255,255,255,0.9);
    }

    .btn-outline-success:hover, .btn-outline-success.active {
        background: var(--osrs-green);
        border-color: var(--osrs-gold);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    .btn-outline-warning {
        border-color: #FF8C00;
        color: #FF8C00;
        background: rgba(255,255,255,0.9);
    }

    .btn-outline-warning:hover, .btn-outline-warning.active {
        background: #FF8C00;
        border-color: var(--osrs-gold);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    .table {
        background: rgba(255,255,255,0.95);
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .table-dark {
        background: linear-gradient(135deg, var(--osrs-dark-brown), var(--osrs-brown)) !important;
        color: var(--osrs-gold) !important;
        font-family: 'MedievalSharp', cursive;
        font-size: 1.1rem;
    }

    .table-striped > tbody > tr:nth-of-type(odd) > td {
        background-color: rgba(245, 230, 211, 0.5);
    }

    .table-hover > tbody > tr:hover > td {
        background-color: rgba(255, 215, 0, 0.2);
        transition: all 0.3s ease;
    }

    .treasure-icon {
        color: var(--osrs-gold);
        animation: bounce 2s infinite;
        filter: drop-shadow(0 0 10px var(--osrs-gold));
    }

    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
    }

    .rune-divider {
        text-align: center;
        margin: 30px 0;
        color: var(--osrs-gold);
        font-size: 2rem;
    }

    .status-badge-finished {
        background: linear-gradient(135deg, var(--osrs-green), #32CD32);
        color: #000000 !important;
        border: 2px solid var(--osrs-gold);
        font-weight: bold;
    }

    .status-badge-selling {
        background: linear-gradient(135deg, #FF8C00, #FFA500);
        color: #000000 !important;
        border: 2px solid var(--osrs-gold);
        font-weight: bold;
    }

    .loading-spinner {
        color: var(--osrs-gold);
        animation: spin 2s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--osrs-blue), #1E90FF);
        border-color: var(--osrs-blue);
        color: white;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }

    .btn-primary:hover {
        background: linear-gradient(135deg, #1E90FF, var(--osrs-blue));
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        border-color: var(--osrs-gold);
        color: white;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add entrance animation to table rows
        document.querySelectorAll('tbody tr').forEach((row, index) => {
            row.style.opacity = '0';
            row.style.transform = 'translateY(20px)';

            setTimeout(() => {
                row.style.transition = 'all 0.6s ease';
                row.style.opacity = '1';
                row.style.transform = 'translateY(0)';
            }, index * 50);
        });
    });
</script>