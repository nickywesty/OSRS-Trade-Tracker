<!-- Floating Particles -->
<div class="floating-particles">
    <i class="fas fa-coins particle" style="top: 15%; left: 10%; animation-delay: 0s;"></i>
    <i class="fas fa-gem particle" style="top: 25%; right: 15%; animation-delay: 1s;"></i>
    <i class="fas fa-coins particle" style="bottom: 30%; left: 20%; animation-delay: 2s;"></i>
    <i class="fas fa-dice-d20 particle" style="bottom: 15%; right: 25%; animation-delay: 3s;"></i>
</div>

<div class="container flex-grow-1 d-flex align-items-center">
    <div class="upload-container">
        <div class="text-center">
            <i class="fas fa-treasure-chest treasure-icon"></i>
            <h1 class="upload-title">üì§ Import Trading Treasures</h1>
            <p class="mb-4" style="color: var(--osrs-brown); font-weight: bold; font-size: 1.1rem;">
                üè∞ Upload your Grand Exchange adventures to the royal archives! üè∞
            </p>
        </div>

        <div class="rune-divider">
            <i class="fas fa-dice-d20"></i> ‚öîÔ∏è <i class="fas fa-scroll"></i> ‚öîÔ∏è <i class="fas fa-dice-d20"></i>
        </div>

        <form action="/upload" method="post" enctype="multipart/form-data" id="uploadForm">
            <div class="drag-drop-area mb-4">
                <i class="fas fa-cloud-upload-alt fa-4x text-muted mb-3" style="color: var(--osrs-brown) !important;"></i>
                <h4 style="color: var(--osrs-brown); font-family: 'MedievalSharp', cursive;">Choose Your Trading Scroll</h4>
                <p class="text-muted mb-4" style="color: var(--osrs-brown) !important;">
                    üìú Select your daily CSV export from the Grand Exchange ledger
                </p>
                <input type="file" name="file" accept=".csv" class="form-control" required id="csvFile">
                <div class="mt-3">
                    <small style="color: var(--osrs-brown); font-weight: bold;">
                        üõ°Ô∏è Supported formats: .csv files only üõ°Ô∏è
                    </small>
                </div>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-import" id="submitBtn">
                    <i class="fas fa-magic me-2"></i>üéØ Import Trading Data
                </button>
            </div>
        </form>

        <div class="rune-divider">
            <i class="fas fa-book"></i> üìñ <i class="fas fa-quill-pen"></i> üìñ <i class="fas fa-book"></i>
        </div>

        <div class="format-info">
            <h6><i class="fas fa-info-circle me-2"></i>üìã Expected CSV Format:</h6>
            <div style="color: var(--osrs-brown);">
                <strong>Required Columns (in this exact order):</strong>
                <ul class="mt-2">
                    <li><strong>First buy time</strong> - When you started buying</li>
                    <li><strong>Last sell time</strong> - When you finished selling</li>
                    <li><strong>Account</strong> - Your character name</li>
                    <li><strong>Item</strong> - What you traded</li>
                    <li><strong>Status</strong> - FINISHED or SELLING</li>
                    <li><strong>Bought</strong> - Quantity purchased</li>
                    <li><strong>Sold</strong> - Quantity sold</li>
                    <li><strong>Avg. buy price</strong> - Average price paid</li>
                    <li><strong>Avg. sell price</strong> - Average price received</li>
                    <li><strong>Tax</strong> - Grand Exchange tax</li>
                    <li><strong>Profit</strong> - Total profit/loss</li>
                    <li><strong>Profit ea.</strong> - Profit per unit</li>
                </ul>
                <div class="mt-3 p-3" style="background: rgba(255,215,0,0.1); border-radius: 10px; border: 2px solid var(--osrs-gold);">
                    <strong style="color: var(--osrs-brown);">üèÜ Pro Tip:</strong>
                    <span style="color: var(--osrs-brown);">The system automatically detects and skips duplicate entries based on timing and item data!</span>
                </div>
            </div>
        </div>

        <div class="text-center mt-4">
            <a href="/" style="color: var(--osrs-brown); text-decoration: none; font-weight: bold; transition: all 0.3s ease;">
                <i class="fas fa-arrow-left me-2"></i>üè† Return to Trading Hall
            </a>
        </div>

        <div class="text-center mt-3">
            <small style="color: var(--osrs-brown); opacity: 0.8; font-style: italic;">
                üè∞ Protected by ancient RuneScape magic ‚Ä¢ Duplicate detection enabled üè∞
            </small>
        </div>
    </div>
</div>

<style>
    body {
        background:
            radial-gradient(circle at 40% 60%, rgba(255,215,0,0.15) 0%, transparent 50%),
            radial-gradient(circle at 80% 30%, rgba(139,69,19,0.12) 0%, transparent 55%),
            radial-gradient(circle at 20% 80%, rgba(255,215,0,0.08) 0%, transparent 45%),
            linear-gradient(155deg, #0f172a 0%, #1e293b 20%, #374151 40%, #4b5563 60%, #6b7280 80%, #4b5563 100%),
            repeating-linear-gradient(135deg, transparent, transparent 4px, rgba(255,215,0,0.03) 4px, rgba(255,215,0,0.03) 8px);
        background-size: 320px 320px, 450px 450px, 250px 250px, 100% 100%, 25px 25px;
        background-attachment: fixed;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        animation: treasureGlow 18s ease-in-out infinite;
    }

    @keyframes treasureGlow {
        0%, 100% { filter: brightness(1) contrast(1); }
        50% { filter: brightness(1.05) contrast(1.1); }
    }

    .upload-container {
        background: linear-gradient(145deg, var(--parchment), #E6D7C3);
        border: 8px solid var(--osrs-brown);
        border-radius: 30px;
        padding: 50px;
        box-shadow:
            0 0 50px rgba(255,215,0,0.5),
            inset 0 0 30px rgba(0,0,0,0.1),
            0 20px 50px rgba(0,0,0,0.5);
        max-width: 700px;
        width: 100%;
        margin: 50px auto;
        position: relative;
        overflow: hidden;
    }

    .upload-container::before {
        content: "";
        position: absolute;
        top: -4px;
        left: -4px;
        right: -4px;
        bottom: -4px;
        background: linear-gradient(45deg, var(--osrs-gold), var(--osrs-brown), var(--osrs-gold));
        z-index: -1;
        border-radius: 34px;
    }

    .upload-title {
        font-family: 'MedievalSharp', cursive;
        color: var(--osrs-brown);
        text-align: center;
        font-size: 2.5rem;
        margin-bottom: 30px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .drag-drop-area {
        border: 4px dashed var(--osrs-brown);
        border-radius: 20px;
        padding: 50px;
        text-align: center;
        background: linear-gradient(145deg, rgba(255,255,255,0.9), rgba(245,245,245,0.8));
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .drag-drop-area::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,215,0,0.3), transparent);
        transition: left 0.5s;
    }

    .drag-drop-area:hover {
        border-color: var(--osrs-gold);
        background: linear-gradient(145deg, rgba(255,255,255,0.95), rgba(255,215,0,0.1));
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(255,215,0,0.3);
    }

    .drag-drop-area:hover::before {
        left: 100%;
    }

    .form-control {
        border: 3px solid var(--osrs-brown);
        border-radius: 15px;
        padding: 15px;
        font-size: 1.1rem;
        background: rgba(255,255,255,0.9);
        transition: all 0.3s ease;
        font-family: 'Cinzel', serif;
    }

    .form-control:focus {
        border-color: var(--osrs-gold);
        box-shadow: 0 0 20px rgba(255,215,0,0.3);
        background: white;
    }

    .btn-import {
        background: linear-gradient(135deg, var(--osrs-blue), #1E90FF);
        border: 4px solid var(--osrs-gold);
        color: white;
        font-weight: bold;
        font-size: 1.3rem;
        padding: 18px 40px;
        border-radius: 20px;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 2px;
        font-family: 'MedievalSharp', cursive;
        position: relative;
        overflow: hidden;
    }

    .btn-import::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.5s;
    }

    .btn-import:hover {
        background: linear-gradient(135deg, #1E90FF, var(--osrs-blue));
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        color: white;
    }

    .btn-import:hover::before {
        left: 100%;
    }

    .treasure-icon {
        color: var(--osrs-gold);
        font-size: 4rem;
        margin-bottom: 20px;
        animation: bounce 2s ease-in-out infinite;
        filter: drop-shadow(0 0 15px var(--osrs-gold));
    }

    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-15px); }
        60% { transform: translateY(-8px); }
    }

    .format-info {
        background: linear-gradient(145deg, rgba(255,255,255,0.8), rgba(240,240,240,0.8));
        border: 3px solid var(--osrs-brown);
        border-radius: 15px;
        padding: 20px;
        margin-top: 30px;
        font-size: 0.95rem;
    }

    .format-info h6 {
        color: var(--osrs-brown);
        font-family: 'MedievalSharp', cursive;
        font-size: 1.2rem;
        margin-bottom: 15px;
    }

    .rune-divider {
        text-align: center;
        margin: 30px 0;
        color: var(--osrs-gold);
        font-size: 2rem;
    }

    .floating-particles {
        position: fixed;
        pointer-events: none;
        z-index: -1;
    }

    .particle {
        position: absolute;
        color: var(--osrs-gold);
        animation: float 6s ease-in-out infinite;
        opacity: 0.4;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        33% { transform: translateY(-30px) rotate(120deg); }
        66% { transform: translateY(-15px) rotate(240deg); }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.getElementById('csvFile');
        const submitBtn = document.getElementById('submitBtn');
        const uploadForm = document.getElementById('uploadForm');
        const dragDropArea = document.querySelector('.drag-drop-area');

        // File input change event
        fileInput.addEventListener('change', function() {
            if (this.files.length > 0) {
                const fileName = this.files[0].name;
                dragDropArea.style.borderColor = 'var(--osrs-green)';
                dragDropArea.style.background = 'linear-gradient(145deg, rgba(34,139,34,0.1), rgba(255,255,255,0.9))';

                // Update the display to show selected file
                const uploadText = dragDropArea.querySelector('h4');
                uploadText.innerHTML = '<i class="fas fa-check-circle me-2" style="color: var(--osrs-green);"></i>üìú ' + fileName + ' selected!';
                uploadText.style.color = 'var(--osrs-green)';
            }
        });

        // Form submission animation
        uploadForm.addEventListener('submit', function() {
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>üîÆ Casting Import Spell...';
            submitBtn.disabled = true;

            // Add some magical effects
            submitBtn.style.background = 'linear-gradient(135deg, #FF8C00, #FFA500)';
            submitBtn.style.transform = 'scale(0.95)';

            setTimeout(() => {
                submitBtn.style.transform = 'scale(1)';
            }, 200);
        });

        // Drag and drop functionality
        dragDropArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.style.borderColor = 'var(--osrs-gold)';
            this.style.background = 'linear-gradient(145deg, rgba(255,215,0,0.2), rgba(255,255,255,0.9))';
        });

        dragDropArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            this.style.borderColor = 'var(--osrs-brown)';
            this.style.background = 'linear-gradient(145deg, rgba(255,255,255,0.9), rgba(245,245,245,0.8))';
        });

        dragDropArea.addEventListener('drop', function(e) {
            e.preventDefault();
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].name.endsWith('.csv')) {
                fileInput.files = files;
                fileInput.dispatchEvent(new Event('change'));
            }
            this.style.borderColor = 'var(--osrs-brown)';
            this.style.background = 'linear-gradient(145deg, rgba(255,255,255,0.9), rgba(245,245,245,0.8))';
        });

        // Add entrance animation
        const uploadContainer = document.querySelector('.upload-container');
        uploadContainer.style.opacity = '0';
        uploadContainer.style.transform = 'translateY(30px)';

        setTimeout(() => {
            uploadContainer.style.transition = 'all 0.8s ease';
            uploadContainer.style.opacity = '1';
            uploadContainer.style.transform = 'translateY(0)';
        }, 100);
    });
</script>